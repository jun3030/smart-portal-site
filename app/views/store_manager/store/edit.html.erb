<div class="container">
  <div class="row">
    <div class="col-md-8 offset-2">
      <% flash.each do |message_type, msg| %>
        <div class="mt-4 alert alert-<%= message_type %>"><%= msg %></div>
      <% end %>
      <h3 class="mt-5 mb-4 text-center"><%= @store.store_name %>の編集</h3>
        <hr>
        <div class="jumbotron">
          <div class="form_group">
            <%= form_with(model: @store, url: store_manager_store_path(@store), method: :patch, local: true) do |sf| %>
              <%= render "shared/error_messages", object: sf.object %>
              <div class="field mt-3">
                <%= sf.label :store_name, class:"mr-2"%><span class="badge badge-danger">必須</span>
                <%= sf.text_field :store_name, class:"form-control" %>
              </div>

              <div class="field mt-3">
                <%= sf.label :adress, class:"mr-2" %>
                <%= sf.text_field :adress,placeholder: "例）東京都墨田区押上１丁目１−２", class:"form-control" %>
              </div>

              <div class="field mt-3">
                <%= sf.label :store_phonenumber, class:"mr-2" %>
                <%= sf.text_field :store_phonenumber, placeholder: "例）012-3456-7890", class:"form-control" %>
              </div>

              <div class="field mt-3">
                <%= sf.label :store_description, class:"mr-2" %>
                <%= sf.text_area :store_description, class:"form-control" %>
              </div>

              <div class="field mt-3">
                <% unless @store.store_images.pluck(:store_image).any? %>
                  <% if @store.store_images.where(store_image: nil).present? %>
                    <%= sf.fields_for :store_images do |sif| %>
                      <%= sif.label :store_image, class:"mr-2" %>画像なしnil<br>
                      <div class="hidden_field">
                      <%= sif.file_field :store_image, id: :store_img_field1, multiple: true %>
                      <%= sif.file_field :store_image, id: :store_img_field2, multiple: true %>
                      <%= sif.file_field :store_image, id: :store_img_field3, multiple: true %>
                      <%= sif.file_field :store_image, id: :store_img_field4, multiple: true %>
                      <%= sif.file_field :store_image, id: :store_img_field5, multiple: true %>
                      </div>
                      <hr>
                    <% end %>
                  <% else %>
<<<<<<< HEAD
                      <%= sf.fields_for :store_images, @store.store_images.build do |sif| %>
                        <%= sif.label :store_image, class:"mr-2" %>画像なしidなし<br>
                        <div class="hidden_field">
                        <%= sif.file_field :store_image, id: :store_img_field1, multiple: true %>
                        <%= sif.file_field :store_image, id: :store_img_field2, multiple: true %>
                        <%= sif.file_field :store_image, id: :store_img_field3, multiple: true %>
                        <%= sif.file_field :store_image, id: :store_img_field4, multiple: true %>
                        <%= sif.file_field :store_image, id: :store_img_field5, multiple: true %>
                        </end>
                        <hr>
                      <% end %>
=======
                    <%= sf.fields_for :store_images, @store.store_images.build do |sif| %>
                      <%= sif.label :store_image, class:"mr-2" %><br>
                      <%= sif.file_field :store_image, multiple: true %>
                    <% end %>
>>>>>>> 9b2dd71091704413786d55c353dd43f5a3e51940
                  <% end %>
                <% else %>
                  <%= sf.fields_for :store_images do |sif| %>
                    <%= sif.label :store_image, class:"mr-2" %><br>
                    <%= sif.file_field :store_image, id: :store_img_field, multiple: true %><br>
                    <span class="image_notice">※画像の更新をする場合は添付する画像を選択してください。</span>
                    <div class="field mt-3">
                      <%= sif.check_box :remove_store_image %>&ensp;画像の削除</span>
                      <p class="image_notice">※画像を削除する場合はチェックボックスにチェックを入れてください。</p>
                    </div>
                  <% end %>
                <% end %>
              </div>

              <!-- プレビュー -->

              <div id="img_field" onClick="$('#store_img_field1').click()">test</div>



              <div class="field mt-3">
                <% unless @store.store_images.pluck(:sm_image).any? %>
                  <% if @store.store_images.where(sm_image: nil).present? %>
                    <%= sf.fields_for :store_images do |sif| %>
                      <%= sif.label :sm_image, class:"mr-2" %><br>
                      <%= sif.file_field :sm_image, multiple: true %><br>
                    <% end %>
                  <% else %>
                      <%= sf.fields_for :store_images, @store.store_images.build do |sif| %>
                        <%= sif.label :sm_image, class:"mr-2" %><br>
                        <%= sif.file_field :sm_image, multiple: true %>
                      <% end %>
                  <% end %>
                <% else %>
                  <%= sf.fields_for :store_images do |sif| %>
                    <%= sif.label :sm_image, class:"mr-2" %><br>
                    <%= sif.file_field :sm_image, multiple: true %><br>
                    <span class="image_notice">※画像の更新をする場合は添付する画像を選択してください。</span>
                    <div class="field mt-3">
                      <%= sif.check_box :remove_sm_image %>&ensp;画像の削除</span>
                      <p class="image_notice">※画像を削除する場合はチェックボックスにチェックを入れてください。</p>
                    </div>
                  <% end %>
                <% end %>
              </div>
            <div class="actions mt-5 text-center">
              <%= sf.submit "更新", class:"btn btn-primary w-75" %>
            </div>
            <% end %>
          </div>
        </div>
      <%= link_to "キャンセル", store_managers_show_path(current_store_manager), class:"top_space" %>
      <%= link_to "top", root_path %>
    </div>
  </div>
<<<<<<< HEAD
</div>

<script src="https://code.jquery.com/jquery-2.2.4.min.js"></script>

<script>
$(document).on('turbolinks:load', function(){
  $(function(){
    //プレビューのhtmlを定義
    function buildHTML(count) {
      var html = `<div class="preview-box" id="preview-box__${count}">
                    <div class="upper-box">
                      <img src="" alt="preview">
                    </div>
                    <div class="lower-box">
                      <div class="update-box">
                        <label class="edit_btn">編集</label>
                      </div>
                      <div class="delete-box" id="delete_btn_${count}">
                        <span>削除</span>
                      </div>
                    </div>
                  </div>`
      return html;
    }
    function readURL(input) {
      $('#store_img_field1').change(function() {

        console.log("test");
      });
    }


  });
})
</script>
=======
</div>
>>>>>>> 9b2dd71091704413786d55c353dd43f5a3e51940
