<div class="top_space">
  <div class="text_width text_left">
    <% flash.each do |message_type, message| %>
      <div class="alert alert-success mt-5 text_left"><%= message %></div>
    <% end %>

    <div class="box-content message-box">
      <table class="table">
        <tbody>
          <tr>
            <td>受信日：<%= @message.created_at.strftime('%m/%d　%H:%M') %></td>
          </tr>
          <tr>
            <td>件名：<%= @message.title %></td>
          </tr>
          <tr>
            <td><%= @message.content %></td>
          </tr>
        </tbody>
      </table>
    </div>
    <h5><%= User.find(@message.user_id).name %></h5>

    <% @replies.each do |r| %>
      <div class="box-content reply-box">
        <table class="table">
          <tbody>
            <tr>
              <td><%= r.reply %></td>
            </tr>
          </tbody>
        </table>
      </div>
      <div class="text-right">
        <h5><%= Store.find(r.store_id).store_manager.name %></h5>
      </div>
    <% end %>

    <%= form_with(model: @reply, url: store_manager_store_message_replies_path(@reply_store, @message),
                  local: true, method: :post) do |f| %>
      <%= render "shared/error_messages", object: f.object %>
      <br>
      <%= f.text_area :reply, size: "30x5", class: "form-control" %><br>

      <%= f.hidden_field :message_id, value: @message.id %>
      <%= f.hidden_field :store_id, value: @message.store_id %>
      <%= f.hidden_field :user_id, value: @message.user_id %>
      <%= f.hidden_field :checked, value: "未読" %>
      <%= f.hidden_field :reply_from, value: "user" %>

      <%= f.submit "メッセージを返信する", class: "message-submit-btn" %>
    <% end %>
    <br>
  </div>
</div>
